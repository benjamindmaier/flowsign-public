<p align="center">
  <img width="250" src="https://raw.githubusercontent.com/benjamindmaier/flowsign-public/refs/heads/main/assets/logo.png">
  <br><br>
  Network Orientation and Sign Prediction using Prior Knowledge and Omics Data
  <br><br>
</p>

> Research paper: [Preprint Coming Soon!](https://www.ebi.ac.uk/research/petsalaki/)  
> Data: [Zenodo](https://zenodo.org/records/18247191?preview=1&token=eyJhbGciOiJIUzUxMiJ9.eyJpZCI6Ijc1ODBiZWM0LWNhMTMtNGZkZS1hNjVmLTVhNWI3OWNlZWYwZiIsImRhdGEiOnt9LCJyYW5kb20iOiIzODIyMmY5ZWFhY2U2NDMwMTYxYjY1ODliNzFiOTAzNSJ9.sSqvH7fqJDCLrsIs9y37ZHyk5RhNTCiV_C7oR0avSQaCdEdBi_6fq9oagkBUEiUk5YsiR4V4yljj9UnDk9FXrw)

[![License](https://img.shields.io/badge/license-MIT-blue)](LICENSE)  
[![R](https://img.shields.io/badge/R-4.5+-blue)](https://www.r-project.org/)  
[![Nextflow](https://img.shields.io/badge/Nextflow-25.04-orange)](https://www.nextflow.io/)

# FlowSign Overview

<p align="center">
  <br>
  <img width="900" src="https://raw.githubusercontent.com/benjamindmaier/flowsign-public/refs/heads/main/assets/graphical_abstract.png">
  <br>
</p>

FlowSign is a computational framework for predicting the **orientation** and **regulatory effect** (activation or inhibition) of edges in undirected human protein interaction networks. By integrating prior knowledge, omics measurements, and optional user annotations, FlowSign uses **network topology, propagation, and maximum-likelihood inference** to generate:

- **Directed and signed networks**  
- **Modular subnetworks**  
- **Shortest-path representations**  

These annotated networks can be directly transformed into executable **Boolean** and **ODE models**, enabling simulation of **context-specific signaling behavior** and supporting the construction of **data-driven digital twins**.

FlowSign is compatible with any protein interaction network, including **context-specific networks** generated by **CHARLIE** [(Paper)](https://doi.org/10.1101/gr.276059.121) [(Webserver)](https://charlie-net.com/) and **phuEGO** [(Paper)](https://doi.org/10.1016/j.mcpro.2024.100771) [(Python-Package)](https://pypi.org/project/phuego/), and allows user-provided annotations to refine predictions. Implemented in **R** and distributed as a **Nextflow pipeline**, FlowSign ensures **scalability** and **reproducibility**.

---

# Build the container image

Requires [Docker](https://www.docker.com) and [Apptainer](https://apptainer.org).

```bash
docker build -t flowsign - < env/Dockerfile
docker save -o env/flowsign.tar.gz flowsign
singularity build env/flowsign.sif docker-archive://env/flowsign.tar.gz
# Customize `nextflow.config`

Modify the following variables according to your infrastructure:

- `process.executor` – the executor for running jobs (e.g., local, slurm, sge)  
- `process.queue` – the queue name for cluster submission  
- `workDir` – the directory for workflow intermediate files  
- `env` – environment variables for R, Python, or tools  

For full guidance, see the [Nextflow configuration documentation](https://www.nextflow.io/docs/latest/config.html).
```

# Usage

FlowSign can be run as a **command-line tool** via Nextflow. By default, outputs are printed to `STDOUT`, making it easy to integrate into pipelines. You can also specify an output directory or file with the `-o` option.

```bash
# Run FlowSign using the standard profile
nextflow run main.nf -profile standard

# Run FlowSign and generate an HTML report
nextflow run main.nf -profile standard -with-report report.html

# Specify a custom output directory
nextflow run main.nf -profile standard -o results/
```

## Input

FlowSign accepts the following inputs:

### Undirected protein interaction network

A tabular file (`.csv` or `.tsv`) representing an **undirected protein–protein interaction (PPI) network**.

**Requirements**
- The first two columns must be named:
  - `Protein1`
  - `Protein2`
- Protein identifiers must be provided as **HGNC gene symbols**, **UniProt**, **Ensembl**, or **Entrez IDs**.

This network serves as the structural backbone for direction and sign inference.

---

### Omics measurements

A tabular file containing **normalized and batch-corrected transcriptomics measurements** across **at least two conditions**.

**Requirements**
- Rows correspond to genes/proteins
- Columns correspond to experimental conditions
- The **first condition** is interpreted as the *treatment / system of interest*
- The **second condition** is interpreted as the *control*

Additional conditions may be included and are used to improve robustness of inference.

---

### User gene annotations

A tabular file (`Gene Annotations`) defining functional roles of selected genes.

**Required columns**
| Column | Description |
|------|-------------|
| `Protein` | Protein identifier (HGNC, UniProt, Ensembl, or Entrez) |
| `Status` | Functional role: `input` (1), `reporter` (2), or `output` (3) |

**Typical use cases**
- **Input genes**: receptors or upstream signaling components  
- **Reporter genes**: marker genes whose expression changes upon stimulation  
- **Output genes**: ligands, transcription factors, or downstream effectors  

These annotations guide network orientation and bottleneck resolution.

---

### User-defined long-distance relationships

A tabular file (`.csv` or `.tsv`) specifying known **long-distance regulatory relationships**.

**Required columns**
| Column | Description |
|------|-------------|
| `Source` | Upstream protein |
| `Target` | Downstream protein |

**Optional column**
| Column | Description |
|------|-------------|
| `Sign` | Regulatory effect (`+1` activation, `-1` inhibition) |

**Notes**
- Identifiers must use HGNC, UniProt, Ensembl, or Entrez IDs
- These relationships may represent indirect effects (e.g., activation of A leads to inhibition of B)
- Direct interactions may also be included and are treated as **prior knowledge**
- These constraints help anchor direction and sign prediction

---

## Output

FlowSign produces the following outputs:

### Directed and signed network

A tabular `.csv` file containing inferred directionality and regulatory signs.

**Columns**
| Column | Description |
|------|-------------|
| `Source` | Upstream protein |
| `Target` | Downstream protein |
| `Direction_Confidence` | Confidence score for edge orientation |
| `Sign` | Regulatory effect (`+1` / `-1`) |
| `Sign_Confidence` | Confidence score for sign assignment |
| `Confidence` | Combined confidence score |

---

### Modular subnetworks

Two tabular outputs describing network modularization:

1. **Node-to-module assignment**
   - Columns: `Protein`, `Status`, `Module`

2. **Module-level interaction network**
   - Columns: `Source_Module`, `Target_Module`, `Direction`, `Sign`

These representations simplify network structure and improve interpretability.

---

### Shortest-path representations

A tabular `.csv` file describing minimal signaling paths.

**Columns**
| Column | Description |
|------|-------------|
| `Source` | Source protein |
| `Target` | Target protein |
| `Minimal_Distance` | Shortest path length (integer) |
| `Minimal_Path` | List of proteins forming the path |

---

## Method

FlowSign predicts **edge orientation** and **regulatory sign** using the following strategy:

- **Integration of prior knowledge** from:
  - Literature and curated pathways  
  - Protein interaction and complex databases  
  - Transcription factor regulons
  - Perturbation Experiments
  - (De)phosphorylation databases and prediction resources
  - Low confidence inference of protein-protein relationships based on sequence similarity/gene paralogs (e.g. if ProteinA1-5 activate ProteinB; we infer Protein A6 probably activates ProteinB as well but assign a lower confidence)

- **Topology-based direction inference**, where bottlenecks are oriented using gene status annotations  
  - For example, if only a single path/bottleneck exists from an input (e.g., receptor) to an output (e.g., ligand), edges are oriented accordingly  
  - If strong prior knowledge contradicts topology, novel interactions may be inferred using the prior knowledge of protein-protein interactions and omics evidence.

- **Maximum-likelihood inference and signal propagation** to assign activation or inhibition signs based on node states and expression changes

- **Network trimming and modularization**, removing:
  - Non-expressed nodes  
  - Nodes with only incoming or only outgoing edges  
  - Compress redundant linear cascades for the shortest-path representation  

This workflow enables **automated construction of context-specific, mechanistic signaling models** with minimal manual curation.


# Cite
Please cite FlowSign in your work using:

FlowSign preprint: Preprint Coming Soon!
FlowSign data: Zenodo

# License
FlowSign is released under the MIT License. See LICENSE for details.